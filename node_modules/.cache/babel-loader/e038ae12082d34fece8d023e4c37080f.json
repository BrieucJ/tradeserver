{"ast":null,"code":"import{API_URL}from'./Constants';export var get=function get(path){var opts=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return makeRequest(path,opts);};export var post=function post(path,data,opts){return makeRequest(path,{method:\"POST\",params:JSON.stringify(data),opts:opts});};export var put=function put(path,data,opts){return makeRequest(path,{method:\"PUT\",params:JSON.stringify(data),headers:{\"Content-Type\":\"application/json\"}});};export var patch=function patch(path,data,opts){return makeRequest(path,{method:\"PATCH\",params:JSON.stringify(data),headers:{\"Content-Type\":\"application/json\"}});};export var destroy=function destroy(path,opts){return makeRequest(path,{method:\"DELETE\"});};export var makeRequest=function makeRequest(path,opts){// console.log('REQUEST')\nvar token=localStorage.getItem('token');var url=API_URL+path;var method=opts.method||\"GET\";opts.headers=opts.headers||{};//   opts.headers[\"Locale\"] = i18n.locale\n//   opts.headers[\"Timezone\"] = Localization.timezone\nopts.headers[\"Accept\"]=\"application/json\";opts.headers[\"Content-Type\"]=\"application/json\";if(token!==undefined){opts.headers[\"Authorization\"]=token;}return new Promise(function(resolve,reject){var xhr=new XMLHttpRequest();xhr.open(method,url);xhr.onload=function(){if(this.status>=200&&this.status<300){resolve(JSON.parse(xhr.response));}else{var resp=JSON.parse(xhr.response).error;reject({status:resp.status,statusText:resp.message});}};xhr.onerror=function(){var resp=JSON.parse(xhr.response).error;reject({status:resp.status,statusText:resp.message});};if(opts.headers){Object.keys(opts.headers).forEach(function(key){xhr.setRequestHeader(key,opts.headers[key]);});}var params=opts.params;// Need to stringify if we've been given an object\n// If we have a string, this is skipped.\nif(params&&typeof params==='object'){params=Object.keys(params).map(function(key){return encodeURIComponent(key)+'='+encodeURIComponent(params[key]);}).join('&');}xhr.send(params);});};","map":{"version":3,"sources":["/Users/brieucjamain/Desktop/TradeServer/src/utils/Api.js"],"names":["API_URL","get","path","opts","makeRequest","post","data","method","params","JSON","stringify","put","headers","patch","destroy","token","localStorage","getItem","url","undefined","Promise","resolve","reject","xhr","XMLHttpRequest","open","onload","status","parse","response","resp","error","statusText","message","onerror","Object","keys","forEach","key","setRequestHeader","map","encodeURIComponent","join","send"],"mappings":"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","sourcesContent":["import {API_URL} from './Constants'\n\nexport const get = (path, opts = {}) => {\n  return makeRequest(path, opts)\n}\n\nexport const post = (path, data, opts) => {\n  return makeRequest(path, {\n    method: \"POST\",\n    params: JSON.stringify(data),\n    opts: opts\n  })\n}\n\nexport const put = (path, data, opts) => {\n  return makeRequest(path, {\n    method: \"PUT\",\n    params: JSON.stringify(data),\n    headers: { \"Content-Type\": \"application/json\" }\n  })\n}\n\nexport const patch = (path, data, opts) => {\n  return makeRequest(path, {\n    method: \"PATCH\",\n    params: JSON.stringify(data),\n    headers: { \"Content-Type\": \"application/json\" }\n  })\n}\n\nexport const destroy = (path, opts) => {\n  return makeRequest(path, { method: \"DELETE\" })\n}\n\nexport const makeRequest = (path, opts) => {\n  // console.log('REQUEST')\n  let token = localStorage.getItem('token')\n  let url = API_URL + path\n  let method = opts.method || \"GET\"\n  opts.headers = opts.headers || {}\n//   opts.headers[\"Locale\"] = i18n.locale\n//   opts.headers[\"Timezone\"] = Localization.timezone\n  opts.headers[\"Accept\"] = \"application/json\"\n  opts.headers[\"Content-Type\"] = \"application/json\"\n  if (token !== undefined) { opts.headers[\"Authorization\"] = token }\n  return new Promise(function (resolve, reject) {\n    var xhr = new XMLHttpRequest();\n    xhr.open(method, url);\n    xhr.onload = function () {\n      if (this.status >= 200 && this.status < 300) {\n        resolve(JSON.parse(xhr.response));\n      } else {\n        var resp = JSON.parse(xhr.response).error;\n        reject({ \n          status: resp.status,\n          statusText: resp.message,\n        });\n      }\n    };\n    xhr.onerror = function () {\n      var resp = JSON.parse(xhr.response).error;\n      reject({\n        status: resp.status,\n        statusText: resp.message,\n      });\n    };\n    if (opts.headers) {\n      Object.keys(opts.headers).forEach(function (key) {\n        xhr.setRequestHeader(key, opts.headers[key]);\n      });\n    }\n    var params = opts.params;\n    // Need to stringify if we've been given an object\n    // If we have a string, this is skipped.\n    if (params && typeof params === 'object') {\n      params = Object.keys(params).map(function (key) {\n        return encodeURIComponent(key) + '=' + encodeURIComponent(params[key]);\n      }).join('&');\n    }\n    xhr.send(params);\n  });\n}"]},"metadata":{},"sourceType":"module"}